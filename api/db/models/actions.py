from .. import db
from .action_type import ActionType


class Action(db.Model):
    """
    This class doesn't inherit from BaseModel because we don't want an
    updated_at field.

    Each action has one actor (a user), and up to 3 other interacted objects,
    which could be of any type, thus we can't make use of foreign keys for them.
    """

    id = db.Column(db.Integer, primary_key=True)
    created_at = db.Column(db.DateTime(timezone=True),
                           server_default=db.func.now(),
                           nullable=False)
    type = db.Column(db.Enum(ActionType), nullable=False)
    user_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)
    obj1_id = db.Column(db.Integer, default=None)
    obj2_id = db.Column(db.Integer, default=None)
    obj3_id = db.Column(db.Integer, default=None)
