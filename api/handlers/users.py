from ..db.models import User
from .auth import auth


def signup(body):
    # TODO validate json input
    # TODO check if user details already exist
    user = User.create(body.get('username'), body.get('email'),
                       body.get('password'))
    return user.to_obj(whos_asking=user)


@auth
def detail(id, auth_user):
    detail_user = User.query.filter_by(id=id).first()
    return detail_user.to_obj(whos_asking=auth_user)
